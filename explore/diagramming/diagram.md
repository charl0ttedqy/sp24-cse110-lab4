see diagram.drawio.png for details
